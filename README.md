

- [å‰è¨€](#%e5%89%8d%e8%a8%80)
- [å¦‚ä½•åˆ›å»ºè‡ªåŠ¨åŒ–æµ‹è¯•](#%e5%a6%82%e4%bd%95%e5%88%9b%e5%bb%ba%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95)
- [åˆ›å»ºå¥½çš„è‡ªåŠ¨åŒ–æµ‹è¯•åœ¨å“ªé‡Œ?](#%e5%88%9b%e5%bb%ba%e5%a5%bd%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95%e5%9c%a8%e5%93%aa%e9%87%8c)
- [å¦‚ä½•ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•](#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95)
- [ç”Ÿå‘½å‘¨æœŸ(è¿è¡Œæµç¨‹)](#%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%e8%bf%90%e8%a1%8c%e6%b5%81%e7%a8%8b)
- [å…·ä½“ä½¿ç”¨ä»‹ç»](#%e5%85%b7%e4%bd%93%e4%bd%bf%e7%94%a8%e4%bb%8b%e7%bb%8d)
  - [åˆå§‹åŒ– App](#%e5%88%9d%e5%a7%8b%e5%8c%96-app)
  - [è·å–å…ƒç´ ](#%e8%8e%b7%e5%8f%96%e5%85%83%e7%b4%a0)
    - [æ ¹æ®ç±»å‹å–å…ƒç´ ](#%e6%a0%b9%e6%8d%ae%e7%b1%bb%e5%9e%8b%e5%8f%96%e5%85%83%e7%b4%a0)
    - [æ ¹æ® label å–å…ƒç´ ](#%e6%a0%b9%e6%8d%ae-label-%e5%8f%96%e5%85%83%e7%b4%a0)
    - [æ ¹æ®ä¸‹æ ‡å–å…ƒç´ ](#%e6%a0%b9%e6%8d%ae%e4%b8%8b%e6%a0%87%e5%8f%96%e5%85%83%e7%b4%a0)
    - [æ ¹æ® identifier å–å…ƒç´ ](#%e6%a0%b9%e6%8d%ae-identifier-%e5%8f%96%e5%85%83%e7%b4%a0)
  - [å¯¹å…ƒç´ çš„æ“ä½œ](#%e5%af%b9%e5%85%83%e7%b4%a0%e7%9a%84%e6%93%8d%e4%bd%9c)
    - [ç‚¹å‡»](#%e7%82%b9%e5%87%bb)
    - [åŒå‡»](#%e5%8f%8c%e5%87%bb)
    - [é•¿æŒ‰](#%e9%95%bf%e6%8c%89)
    - [æ»‘åŠ¨](#%e6%bb%91%e5%8a%a8)
    - [æåˆ](#%e6%8d%8f%e5%90%88)
    - [æ—‹è½¬](#%e6%97%8b%e8%bd%ac)
- [å®é™…ç”¨ä¾‹](#%e5%ae%9e%e9%99%85%e7%94%a8%e4%be%8b)
  - [å…·ä½“ç‚¹å‡» UITableView æŸä¸€è¡Œ](#%e5%85%b7%e4%bd%93%e7%82%b9%e5%87%bb-uitableview-%e6%9f%90%e4%b8%80%e8%a1%8c)
  - [ç›´æ¥æ‰“å¼€å…¶ä»– App](#%e7%9b%b4%e6%8e%a5%e6%89%93%e5%bc%80%e5%85%b6%e4%bb%96-app)
  - [ç³»ç»Ÿæ¡Œé¢ App(springboard)](#%e7%b3%bb%e7%bb%9f%e6%a1%8c%e9%9d%a2-appspringboard)
  - [ç”³è¯·ç³»ç»Ÿæƒé™, ç‚¹å‡»ç³»ç»Ÿæƒé™å¼¹æ¡†(ä¾‹å¦‚é€šçŸ¥æƒé™)](#%e7%94%b3%e8%af%b7%e7%b3%bb%e7%bb%9f%e6%9d%83%e9%99%90-%e7%82%b9%e5%87%bb%e7%b3%bb%e7%bb%9f%e6%9d%83%e9%99%90%e5%bc%b9%e6%a1%86%e4%be%8b%e5%a6%82%e9%80%9a%e7%9f%a5%e6%9d%83%e9%99%90)
  - [Homeé”®](#home%e9%94%ae)
  - [ç³»ç»ŸéŸ³é‡æŒ‰é”®](#%e7%b3%bb%e7%bb%9f%e9%9f%b3%e9%87%8f%e6%8c%89%e9%94%ae)
  - [Siri](#siri)
  - [è®¾å¤‡è½¬æ–¹å‘](#%e8%ae%be%e5%a4%87%e8%bd%ac%e6%96%b9%e5%90%91)
- [é¡¹ç›®åœ°å€](#%e9%a1%b9%e7%9b%ae%e5%9c%b0%e5%9d%80)

# å‰è¨€

æœ€è¿‘æ­£åœ¨å­¦ä¹  iOS è‡ªåŠ¨åŒ–æµ‹è¯•(ç³»ç»Ÿè‡ªå¸¦çš„ XCTest), å°±æ€»ç»“ä¸€ä¸‹è‡ªåŠ¨åŒ–æµ‹è¯•ä¸€äº›çŸ¥è¯†.  

# å¦‚ä½•åˆ›å»ºè‡ªåŠ¨åŒ–æµ‹è¯•

å°±ä¸ä»‹ç»ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•äº†ï¼Œç›´æ¥å¼€æ

è¿™é‡Œåˆ†ä¸¤ç§æƒ…å†µ

1. åˆšæ–°å»ºé¡¹ç›®

åˆ›å»ºé¡¹ç›®æ—¶, å‹¾ä¸Š Include UI Tests å³å¯

![å›¾ç‰‡](Images/00.png)


2. å·²æœ‰äº†é¡¹ç›®ï¼Œå´æ²¡æœ‰è‡ªåŠ¨åŒ–æµ‹è¯•

å…¶å®å°±æ˜¯æ·»åŠ  target  
æˆ‘ä»¬ç‚¹å‡» '+' å·, 

![å›¾ç‰‡](Images/01.png)

é€‰æ‹© UI Testing Bundle

![å›¾ç‰‡](Images/02.png)



# åˆ›å»ºå¥½çš„è‡ªåŠ¨åŒ–æµ‹è¯•åœ¨å“ªé‡Œ?

åˆ›å»ºå¥½ä¹‹å, æ˜¯åœ¨è¯¥ç›®å½•ä¸‹(çœ‹å›¾), é»˜è®¤åç§°æ˜¯ é¡¹ç›®å + UITests  
çœ‹åˆ°è¿™é‡Œ, å†™è¿‡ app extension çš„è€å“¥åº”è¯¥éƒ½æ˜ç™½äº†, å…¶å®è¿™ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•å°±æ˜¯ä¸€ä¸ª app extension æ¥çš„, æˆ‘ä»¬å¯ä»¥éšæ„åˆ é™¤å’Œåˆ›å»º, ç”šè‡³åˆ›å»ºå¤šä¸ªéƒ½æ˜¯æ²¡é—®é¢˜çš„  

![å›¾ç‰‡](Images/03.png)


# å¦‚ä½•ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•

è¿™é‡Œä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æ³•

1. åœ¨ Show the Test Navigator ä¸­ä½¿ç”¨

å¦‚å›¾, æ”¾é¼ æ ‡åˆ°, æ”¾åœ¨å‡½æ•°ä¸Š, ä¾‹å¦‚ testExample()  
è¿™æ—¶æˆ‘ä»¬å°±èƒ½çœ‹åˆ°å³è¾¹æœ‰ä¸ªæ’­æ”¾çš„å°ç®­å¤´, ç‚¹å‡»è¿™ä¸ªå°ç®­å¤´, æˆ‘ä»¬å°±å¼€å§‹è¿è¡Œè¿™ä¸ª testExample() å‡½æ•°äº†  
å¦‚æœè¿è¡Œå¤§å†™ T(XQUITestDemoUITests), å°±æ˜¯è¿è¡Œè¿™ä¸ªæµ‹è¯•æ¨¡å—ä¸­æ‰€æœ‰å‡½æ•°çš„æ„æ€  
è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•, å’Œè¿è¡Œé¡¹ç›®ä¸€æ ·çš„, å¯ä»¥å…ˆé€‰æ‹©è®¾å¤‡, å°±æ˜¯é€‰æ‹©çœŸæœºæˆ–è€…æŸä¸ªæ¨¡æ‹Ÿå™¨  

> åˆšåˆ›å»ºæ—¶, åªæœ‰ testLaunchPerformance() å’Œ testExample() ä¸¤ä¸ªå‡½æ•°  
> å…¶ä»–å‡½æ•°æ˜¯æˆ‘åé¢å†™çš„  

![å›¾ç‰‡](Images/04.png)


2. åœ¨ UITest æ¨¡å—çš„ .swift æ–‡ä»¶é‡Œé¢é€‰æ‹©è¿è¡Œ

ä¸Šé¢çš„ testExample() è¿™äº›å‡½æ•°, å…¶å®å°±æ˜¯å…³è”è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å‡½æ•°
æˆ‘ä»¬ç‚¹å¼€ UITest æ¨¡å—çš„ .swift æ–‡ä»¶(å¦‚ä¸‹å›¾), å°±ä¸€åˆ‡æ˜äº†äº†

![å›¾ç‰‡](Images/05.png)

ä»£ç è¡Œæ•°é‚£é‡Œçš„å››è¾¹å½¢, ç‚¹å‡»æ•ˆæœå’Œä¸Šé¢è¯´çš„ä¸€æ ·, å°±æ˜¯è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•  
ç‚¹å‡» class æ—è¾¹çš„è¿è¡Œ, æ˜¯è¿è¡Œæ•´ä¸ªç±»é‡Œé¢æ‰€æœ‰å‡½æ•°çš„(å’Œä¸Šé¢è¯´çš„è¿è¡Œæ•´ä¸ªæµ‹è¯•æ¨¡å—ä¸€æ ·)

> æ³¨æ„! èƒ½å•ç‹¬æ‰§è¡Œçš„å‡½æ•°ä¸€å®šè¦ test å¼€å¤´(å°±æ˜¯æ—è¾¹æœ‰å››è¾¹å½¢çš„å‡½æ•°)
> å°±æ¯”å¦‚ testA() è¿™ä¸ªå°±æ˜¯å¯ä»¥çš„.  methodA() æ—è¾¹å°±æ²¡æœ‰å››è¾¹å½¢.

# ç”Ÿå‘½å‘¨æœŸ(è¿è¡Œæµç¨‹)

å‘¨æœŸå¦‚ä¸‹ 

1. setUp()
2. è‡ªå®šä¹‰æ‰§è¡Œçš„å‡½æ•°
3. tearDown()


è¿™é‡Œæœ‰ä¸ªç‚¹, è¦æ³¨æ„ä¸€ä¸‹, æ¯”å¦‚ä½ å½“å‰æµ‹è¯•æ¨¡å—é‡Œé¢æœ‰ testA(), testB() ä¸¤ä¸ªå‡½æ•°.  
ç„¶åä½ ç›´æ¥ç‚¹å‡»è¿è¡Œæ•´ä¸ªæµ‹è¯•æ¨¡å—, ä»–æ‰§è¡Œçš„é¡ºåºæ˜¯.  

1. setUp()
2. testA()
3. tearDown()

ç„¶åå†æ‰§è¡Œ

1. setUp()
2. testB()
3. tearDown()

å°±æ˜¯ä½ ä¼šçœ‹åˆ°APPå¯åŠ¨å’Œå…³é—­äº†ä¸¤æ¬¡.  

# å…·ä½“ä½¿ç”¨ä»‹ç»


## åˆå§‹åŒ– App 

```swift
// åˆå§‹åŒ– XCUIApplication
let app = XCUIApplication()
// å¯åŠ¨app 
app.launch()

// é»˜è®¤ä¸å¡« bundleIdentifier, å°±ä¼šåˆå§‹åŒ–å½“å‰é¡¹ç›®APP
// å¦‚æœæ˜¯æƒ³æå…¶ä»–APP, å¯ä¼ å…¥ bundleIdentifier åˆå§‹åŒ–, å°±å¯è·å¾—å…¶å®ä¾‹
let sefariApp = XCUIApplication.init(bundleIdentifier: "com.apple.mobilesafari")
```

æ³¨æ„, ä»¥ä¸‹æ–‡ç« å‡ºç° app çš„ä»£ç , éƒ½æ˜¯æŒ‡ä»£ let app = XCUIApplication() è¿™ä¸ª

## è·å–å…ƒç´ 

è¿™é‡Œæˆ‘å°±ä¸¾ä¾‹å‡ ç§å¸¸ç”¨çš„å°±è¡Œ, å…¶ä»–çš„, å¤§å®¶å¯è‡ªè¡Œç ”ç©¶

### æ ¹æ®ç±»å‹å–å…ƒç´ 

å¯ç›´æ¥æŸ¥çœ‹ç³»ç»Ÿ XCUIElementTypeQueryProvider

![å›¾ç‰‡](Images/06.png)

æ¯”å¦‚è¿™æ ·å°±èƒ½å–å¾—è¯¥ app ä¸‹é¢æ‰€æœ‰çš„ button  

```swift
app.buttons
```

ä½†å–åˆ° XCUIElementQuery, è¿˜ä¸èƒ½ç›´æ¥ç”¨   
è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å–åˆ°å…·ä½“æŸä¸ªå…ƒç´ æ‰è¡Œ  

ä¸ºäº†æ¯”è¾ƒå¥½æ˜ç™½, è¿™é‡Œæˆ‘ä¸¾ä¸€ä¸ªä¾‹å­, UIæ˜¯è¿™æ ·  

![å›¾ç‰‡](Images/07.png)

ä»¥ä¸‹å°±æ˜¯ print(app.debugDescription) è¾“å‡ºçš„æ•°æ®    
è¿™é‡Œå†å•°å—¦ä¸€ä¸‹, debugDescription å±æ€§å¯¹äºè·å–å…ƒç´ å±‚çº§æ¥è¯´æŒºèˆ’æœçš„, æˆ‘ä»¬è¦è®°å¾—å¸¸ç”¨ debugDescription  

```
 â†’Application, 0x2819e7720, pid: 4843, label: 'XQUITestDemo'
    Window (Main), 0x2819e78e0, {{0.0, 0.0}, {375.0, 667.0}}
      Other, 0x2819e79c0, {{0.0, 0.0}, {375.0, 667.0}}
        Other, 0x2819e7aa0, {{0.0, 0.0}, {375.0, 667.0}}
          Other, 0x2819e7b80, {{0.0, 0.0}, {375.0, 667.0}}
            Other, 0x2819e7c60, {{0.0, 0.0}, {375.0, 667.0}}
              Other, 0x2819e7d40, {{0.0, 0.0}, {375.0, 667.0}}
                Other, 0x2819e7e20, {{0.0, 0.0}, {375.0, 667.0}}
                  NavigationBar, 0x2819e7f00, {{0.0, 20.0}, {375.0, 44.0}}, identifier: 'æˆ‘çš„'
                    StaticText, 0x2819e8000, {{170.0, 32.0}, {35.0, 20.5}}, label: 'æˆ‘çš„'
                  Other, 0x2819e80e0, {{0.0, 0.0}, {375.0, 667.0}}
                    Other, 0x2819e81c0, {{0.0, 0.0}, {375.0, 667.0}}
                      Other, 0x2819e82a0, {{0.0, 64.0}, {375.0, 603.0}}
                        Button, 0x280c8eae0, {{30.0, 214.0}, {60.0, 60.0}}, identifier: 'touchMe', label: 'ç‚¹æˆ‘'
                          StaticText, 0x2819e8460, {{41.5, 233.0}, {37.0, 22.0}}, label: 'ç‚¹æˆ‘'
            TabBar, 0x2819e8540, {{0.0, 618.0}, {375.0, 49.0}}
              Button, 0x2819e8620, {{2.0, 619.0}, {184.0, 48.0}}, label: 'é¦–é¡µ'
              Button, 0x2819e1b20, {{190.0, 619.0}, {183.0, 48.0}}, label: 'æˆ‘çš„', Selected
      Other, 0x2819e1a40, {{0.0, 0.0}, {375.0, 667.0}}, Disabled
        Other, 0x2819e0b60, {{0.0, 0.0}, {375.0, 667.0}}, identifier: 'SVProgressHUD'
    Window, 0x2819e1ce0, {{0.0, 0.0}, {375.0, 667.0}}
      Other, 0x2819e1f80, {{0.0, 0.0}, {375.0, 667.0}}
        Other, 0x2819e2060, {{0.0, 0.0}, {375.0, 667.0}}
```


> æ³¨æ„, Other å¯¹åº”çš„æ˜¯ UIView

æˆ‘ä»¬ç°åœ¨è¦ç‚¹å‡» tabbar é¦–é¡µè¿™ä¸ªæŒ‰é’®, è·³è½¬åˆ°é¦–é¡µ  
é‚£ä¹ˆè¯¥æ€ä¹ˆåšå‘¢? å¾ˆç®€å•, ä»£ç å°±ä¸¤å¥  

```swift
// å–å…ƒç´ 
let homePageBtn = app.tabBars.buttons["é¦–é¡µ"]
// ç‚¹å‡»å…ƒç´ 
homePageBtn.tap()
```

è¿™é‡Œæˆ‘è§£æä¸€ä¸‹ç¬¬ä¸€å¥å–å…ƒç´ 

app.tabBars å–åˆ°çš„æ˜¯ä»¥ä¸‹æ•°æ®

```
TabBar, 0x2835c3800, {{0.0, 618.0}, {375.0, 49.0}}
    Button, 0x2835c38e0, {{2.0, 619.0}, {184.0, 48.0}}, label: 'é¦–é¡µ'
    Button, 0x2835c39c0, {{190.0, 619.0}, {183.0, 48.0}}, label: 'æˆ‘çš„', Selected
```

ç„¶å app.tabBars.buttons å–åˆ°çš„æ˜¯

```
Button, 0x2835c38e0, {{2.0, 619.0}, {184.0, 48.0}}, label: 'é¦–é¡µ'
Button, 0x2835c39c0, {{190.0, 619.0}, {183.0, 48.0}}, label: 'æˆ‘çš„', Selected
```

è¿™ä¸ªæ—¶å€™, æˆ‘ä»¬æ ¹æ®ç±»å‹å–å…ƒç´ , å°±å·²ç»å–åˆ°æœ€åäº†  
æƒ³å–é¦–é¡µæŒ‰é’®çš„è¯, æœ‰å‡ ç§æ–¹æ³•, è¯·ç»§ç»­å¾€ä¸‹çœ‹  

### æ ¹æ® label å–å…ƒç´ 

æ ¹æ® label æ¥è·å– button

```swift
app.tabBars.buttons["é¦–é¡µ"]
```

å½“ç„¶, æŒ‰ç…§å½“å‰è¿™ä¸ªUI, æœ€ç®€å•å°±æ˜¯ app.buttons["é¦–é¡µ"]   
ä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿæ›´å‡†ç¡®çš„å–åˆ°æŸä¸ªå…ƒç´ , æœ€å¥½ä¸è¦åå•¬ä¸€ç‚¹ä»£ç 

### æ ¹æ®ä¸‹æ ‡å–å…ƒç´ 

å› ä¸ºæ‰“å°çš„æ•°æ®, é‡Œé¢çš„å…ƒç´ æ˜¯æœ‰åºçš„. é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥è·å–å…ƒç´   

```swift
// ä¼ å…¥å…·ä½“çš„ä¸‹æ ‡, å–å‡ºæŒ‰é’®
app.tabBars.buttons.element(boundBy: 0)

// å½“ç„¶, ä¹Ÿæœ‰ç±»ä¼¼æ•°ç»„ä¸€æ ·å–æ³•, å–ç¬¬ä¸€ä¸ª
app.windows.tabBars.firstMatch
```


### æ ¹æ® identifier å–å…ƒç´ 

ä¸è¿‡ä½ è¦æå‰åœ¨é¡¹ç›®çš„ä»£ç , æˆ–è€… xib ä¸­è®¾ç½®å¥½ identifier æ‰è¡Œ

```swift
// è¿™é‡Œå–çš„ä¸æ˜¯ tabbar çš„ é¦–é¡µæŒ‰é’®, æ˜¯é‚£ä¸ªé»„è‰²æŒ‰é’®
app.tabBars.element(matching: .button, identifier: "touchMe")
```


* åœ¨ä»£ç ä¸­è®¾ç½®


accessibilityIdentifier å°±æ˜¯è®¾ç½®è‡ªåŠ¨åŒ–æµ‹è¯•æ—¶çš„ identifier

```swift
let btn = UIButton()
btn.frame = CGRect.init(x: 30, y: 150, width: 60, height: 60)
btn.setTitle("ç‚¹æˆ‘", for: .normal)
btn.backgroundColor = UIColor.orange
btn.accessibilityIdentifier = "touchMe"
```


* xib æˆ–è€… storyboard ä¸­è®¾ç½®


![å›¾ç‰‡](Images/08.png)



## å¯¹å…ƒç´ çš„æ“ä½œ

ä»¥ä¸‹ button å°±ä»£è¡¨æ˜¯ä¸€ä¸ªæŒ‰é’®å…ƒç´ ( XCUIElementç±» )

### ç‚¹å‡»

```swift
button.tap()
```

### åŒå‡»

```swift
button.doubleTap()
```

### é•¿æŒ‰

```swift
// é•¿æŒ‰ä¸‰ç§’
button.press(forDuration: 3)
```

### æ»‘åŠ¨

```swift
// ä¸Šæ‰«
button.swipeUp()

// ä¸‹æ‰«
button.swipeDown()

// å·¦æ‰«
button.swipeLeft()

// å³æ‰«
button.swipeRight()

```

### æåˆ

```swift
button.pinch(withScale: 1.5, velocity: 1)
```

### æ—‹è½¬

```swift
button.rotate(0.5, withVelocity: 1)
```




# å®é™…ç”¨ä¾‹

è¿™é‡Œä¸¾ä¾‹ä¸€äº›æˆ‘å­¦ä¹ çš„æ—¶å€™, æœäº†æŒºä¹…, éƒ½æ²¡æœåˆ°çš„å®é™…ç”¨ä¾‹å§  
è¿™äº›ç”¨ä¾‹æˆ‘éƒ½æ”¾åœ¨äº† [é¡¹ç›®](https://github.com/SyKingW/XQUITestDemo) é‡Œé¢ï¼Œæœ‰å…´è¶£çš„ï¼Œå¯ç›´æ¥å»ä¸‹è½½ [é¡¹ç›®](https://github.com/SyKingW/XQUITestDemo) è¿è¡Œä¸€ä¸‹


## å…·ä½“ç‚¹å‡» UITableView æŸä¸€è¡Œ

ç¤ºä¾‹ UI å¦‚ä¸‹

![å›¾ç‰‡](Images/09.png)

æ‰“å° app.debugDescription æ•°æ®å¦‚ä¸‹

```
 â†’Application, 0x2838da060, pid: 1007, label: 'XQUITestDemo'
    Window (Main), 0x2838db560, {{0.0, 0.0}, {375.0, 667.0}}
      Other, 0x2838db640, {{0.0, 0.0}, {375.0, 667.0}}
        Other, 0x2838db720, {{0.0, 0.0}, {375.0, 667.0}}
          Other, 0x2838db800, {{0.0, 0.0}, {375.0, 667.0}}
            Other, 0x2838db8e0, {{0.0, 0.0}, {375.0, 667.0}}
              Other, 0x2838db9c0, {{0.0, 0.0}, {375.0, 667.0}}
                Other, 0x2838dbaa0, {{0.0, 0.0}, {375.0, 667.0}}
                  NavigationBar, 0x2838dbb80, {{0.0, 20.0}, {375.0, 44.0}}, identifier: 'TableView'
                    Button, 0x2838dbc60, {{0.0, 20.0}, {62.0, 44.0}}, label: 'é¦–é¡µ'
                    StaticText, 0x2838dbd40, {{147.0, 32.0}, {81.0, 20.5}}, label: 'TableView'
                  Other, 0x2838dbe20, {{0.0, 0.0}, {375.0, 667.0}}
                    Other, 0x2838dbf00, {{0.0, 0.0}, {375.0, 667.0}}
                      Other, 0x2838de760, {{0.0, 64.0}, {375.0, 603.0}}
                        Table, 0x2838debc0, {{0.0, 64.0}, {375.0, 611.0}}
                          Cell, 0x2838dea00, {{0.0, 64.0}, {375.0, 43.5}}
                            Image, 0x2838d0000, {{15.0, 73.5}, {24.0, 24.0}}
                            StaticText, 0x2838d00e0, {{54.0, 64.0}, {306.0, 43.5}}, label: 'æµ‹è¯•: 0'
                            Other, 0x2838d01c0, {{54.0, 107.0}, {321.0, 0.5}}
                            Button, 0x2838d02a0, {{281.0, 69.0}, {74.0, 34.0}}, label: 'æˆ‘æ˜¯æŒ‰é’®'
                              StaticText, 0x2838d0380, {{281.0, 75.0}, {74.0, 22.0}}, label: 'æˆ‘æ˜¯æŒ‰é’®'
                          Cell, 0x2838d0460, {{0.0, 107.5}, {375.0, 43.5}}
                            Image, 0x2838d0540, {{15.0, 117.0}, {24.0, 24.0}}
                            StaticText, 0x2838d0620, {{54.0, 107.5}, {306.0, 43.5}}, label: 'æµ‹è¯•: 1'
                            Other, 0x2838d0700, {{54.0, 150.5}, {321.0, 0.5}}
                            Button, 0x2838d07e0, {{281.0, 112.5}, {74.0, 34.0}}, label: 'æˆ‘æ˜¯æŒ‰é’®'
                              StaticText, 0x2838d08c0, {{281.0, 118.5}, {74.0, 22.0}}, label: 'æˆ‘æ˜¯æŒ‰é’®'
                          ...åé¢ cell å°±çœç•¥äº†, éƒ½æ˜¯ä¸€æ ·çš„æ•°æ®æ ¼å¼
            TabBar, 0x2838f0fc0, {{0.0, 618.0}, {375.0, 49.0}}
              Button, 0x2838f10a0, {{2.0, 619.0}, {184.0, 48.0}}, label: 'é¦–é¡µ', Selected
              Button, 0x2838f1180, {{190.0, 619.0}, {183.0, 48.0}}, label: 'æˆ‘çš„'
```

å…¶å®é€»è¾‘æŒºç®€å•, å°±æ˜¯æ‰¾å‡º cell, ç„¶åå¹¶ä¸”ç‚¹å‡»è€Œå·²  
å…¶å®æœ€å…³é”®çš„å­—æ®µæ˜¯ ==isHittable==, è¯·çœ‹ä»¥ä¸‹ä»£ç , è™½ç„¶æœ‰ç‚¹é•¿. ä¸è¿‡è¯·è€å¿ƒçœ‹å®Œ    

```swift


class XQUITestDemoUITests: XCTestCase {

  /// æµ‹è¯• tableView
  func testTableView() {

    // åˆå§‹åŒ–, å¹¶æ‰“å¼€APP
    let app = XCUIApplication()
    app.launch()

    // è¯»å– tableView å…ƒç´ 
    let tables = app.tables.firstMatch

    // è·å–ä¸‹æ ‡ 30 çš„ cell
    let cell = tables.cells.element(boundBy: 30)
    // è°ƒç”¨å°è£…çš„æ–¹æ³•, æ»šåŠ¨åˆ°è¯¥ cell
    if tables.xq_scrollToElement(element: cell) {
      // å·²ç»æ‰¾åˆ° cell, ç‚¹å‡» cell
      cell.tap()
    }

  }

}


/// å¯¹äº tableview çš„å°è£…
extension XCUIElement {
    /// æ»šåŠ¨åˆ°æŸä¸ªå…ƒç´ 
    /// é»˜è®¤å‘ä¸‹æ»šåŠ¨
    /// è¿™é‡Œå¯ä»¥å†å°è£…ä¸€ä¸‹çš„ï¼Œæ¯”å¦‚å¯ä»¥å‘ä¸Šæ»šåŠ¨, å¯ä»¥æ— é™å¾ªç¯ä¸Šä¸‹æ»šåŠ¨ç­‰ç­‰...
    /// - Parameter element: UIå…ƒç´ 
    /// - Parameter isAutoStop: true æ»šåŠ¨åˆ°æœ€åä¸€ä¸ª, è‡ªåŠ¨åœä¸‹æ¥
    ///
    /// è¿”å› true è¡¨ç¤ºæ‰¾åˆ°äº†ä¼ å…¥çš„å…ƒç´ 
    ///
    func xq_scrollToElement(element: XCUIElement, isAutoStop: Bool = true) -> Bool {

        // åˆ¤æ–­æ˜¯å¦æ˜¯, tableView
        if self.elementType != .table {
            return false
        }

        // ä¸€ç›´æ»šåŠ¨åˆ°æŸä¸ªå…ƒç´ å¯è¢«ç‚¹å‡»ä¸ºæ­¢
        while !element.isHittable {
            
            // æ»šåŠ¨åˆ°æœ€åå°±åœä¸‹æ¥
            if isAutoStop {
              // è·å–æœ€åä¸€ä¸ªå…ƒç´ 
                let lastElement = self.cells.element(boundBy: self.cells.count - 1)
                // æ»šåŠ¨åˆ°æœ€åäº†, é‚£ä¹ˆå°±åœä¸‹æ¥
                if lastElement.isHittable {
                    return false
                }
            }
            
            self.swipeUp()
        }

        return true
    }
}
```


## ç›´æ¥æ‰“å¼€å…¶ä»– App

è¿™é‡Œä¸¾ä¾‹æ‰“å¼€ Safari.  

```swift
// ä¼ å…¥ bundle id, åˆå§‹åŒ–æŸä¸ª app
let safariApp = XCUIApplication.init(bundleIdentifier: "com.apple.mobilesafari")
safariApp.launch()
```

å½“ç„¶, æˆ‘ä»¬æ‰“å¼€ Safari ä¹‹å, ä¹Ÿèƒ½å–åˆ° safari ä¸Šé¢çš„å…ƒç´ , å¹¶ä¸”èƒ½æ“ä½œ  

## ç³»ç»Ÿæ¡Œé¢ App(springboard)

å¦‚æœæˆ‘ä»¬æƒ³å»è·å–å½“å‰çŠ¶æ€æ ä¸Šé¢çš„ä¿¡æ¯. æ¯”å¦‚ç”µé‡, æ˜¯å¦æ­£å¸¸å……ç”µ, ä¿¡å·å¼ºåº¦è¿™äº›çš„  
å…¶å®å¯ä»¥é€šè¿‡åˆå§‹åŒ–æ¡Œé¢APPï¼Œæ¥è·å–çš„  

```swift
// æ³¨æ„, è¿™é‡Œä¸ç”¨ launch() äº† 
let springboard = XCUIApplication.init(bundleIdentifier: "com.apple.springboard")
// ç¬¬ä¸€æ¬¡è·å–æ¡Œé¢å…ƒç´ ä¿¡æ¯, æœ‰æ—¶å€™ä¼šç‰¹åˆ«æ…¢...æ‰€ä»¥è¿™é‡Œå¹¶ä¸æ˜¯å¡æ­»äº†, è¯·è€å¿ƒç­‰å¾…
// ä¸çŸ¥é“å…¶ä¸­ç¼˜ç”±ï¼Œæ„Ÿè§‰æœ‰ç‚¹ç„å­¦
// åæ­£æˆ‘æµ‹çš„æ—¶å€™ä¸€èˆ¬è¦ç­‰å¾… 3 ~ 20 ç§’
print(safariApp.debugDescription)
```

å½“ç„¶ï¼Œ æˆ‘ä»¬å¯ä»¥è°ƒç”¨ Home é”®, å›åˆ°æ¡Œé¢, ç„¶åæ ¹æ®è·å–çš„ä¿¡æ¯, å»ç‚¹å‡»æ¡Œé¢APPï¼Œè¿™æ ·ä¹Ÿå¯ä»¥è¡Œå¾—é€š  
è¿™ä¸ª springboard å¯ä»¥æå¾ˆå¤šéªšæ“ä½œ, å…·ä½“å¯çœ‹æˆ‘é¡¹ç›®, é‡Œé¢æœ‰ä¸€äº›å®é™…ç”¨ä¾‹

## ç”³è¯·ç³»ç»Ÿæƒé™, ç‚¹å‡»ç³»ç»Ÿæƒé™å¼¹æ¡†(ä¾‹å¦‚é€šçŸ¥æƒé™)


ä»£ç å¦‚ä¸‹

```swift

class XQUITestDemoUITests: XCTestCase {

    /// æµ‹è¯•ç³»ç»ŸæŒ‰é’®è‡ªåŠ¨ç‚¹å‡», é€šçŸ¥æƒé™
    func testSystemAlertNotification() {

      // åˆå§‹åŒ–, å¹¶æ‰“å¼€APP
      let app = XCUIApplication()
      app.launch()
        
        // ç‚¹å‡» app é‡Œé¢çš„ cell, å»ç”³è¯·é€šçŸ¥æƒé™
      let view = app.windows.cells.element(boundBy: 9)
      view.tap()
        
        // è°ƒç”¨å°è£…å¥½çš„æ–¹æ³•, ç‚¹å‡»ä¸‹æ ‡ 1 çš„ç³»ç»Ÿ Alert æŒ‰é’®
        // ä¸‹æ ‡ 1, å°±æ˜¯å³è¾¹åŒæ„æŒ‰é’®
      self.xq_tapSystemAlert(index: 1)
        
        // ç­‰å¾…ä¸€ä¼š
      let _ = app.wait(for: .notRunning, timeout: 3)
    }

}
    


extension XCTestCase {

    /// ç‚¹å‡»ç³»ç»Ÿå¼¹æ¡†
    /// - Parameter index: æŒ‰é’®çš„ä¸‹æ ‡.
    /// ä¸‹æ ‡æ˜¯ä»å·¦è¾¹å¼€å§‹ç®—èµ·, 0ä¸ºèµ·å§‹ä¸‹æ ‡.   å°±æ¯”å¦‚é€šçŸ¥æƒé™, è¦åŒæ„çš„è¯, å°±ä¼ å…¥ 1
    func xq_tapSystemAlert(index: Int) {
        let springboard = XCUIApplication.init(bundleIdentifier: "com.apple.springboard")
        springboard.xq_tapAlert(index: index)
    }
    
}

extension XCUIApplication {
    
    ///
    /// æ³¨æ„, actionSheet çš„å¼¹æ¡†æ˜¯æ²¡åŠæ³•è°ƒç”¨è¿™ä¸ªç‚¹å‡»çš„.
    /// å› ä¸º actionSheet æ˜¯ç”¨ä¸¤ä¸ª ScrollView ç»„æˆ...å¹¶ä¸”ç³»ç»Ÿä¸è®¤ä¸ºä»–æ˜¯ä¸€ä¸ª alert...
    ///
    
    /// ç‚¹å‡»å¼¹æ¡†
    /// - Parameter index: æŒ‰é’®çš„ä¸‹æ ‡.
    /// ä¸‹æ ‡æ˜¯ä»å·¦è¾¹å¼€å§‹ç®—èµ·, 0ä¸ºèµ·å§‹ä¸‹æ ‡.
    func xq_tapAlert(index: Int) {
        let alerts = self.windows.alerts
        if alerts.count > 0 {
            let _ = self.wait(for: .notRunning, timeout: 1)
            alerts.buttons.element(boundBy: index).tap()
            let _ = self.wait(for: .notRunning, timeout: 1)
        }
    }
    
}

```



## Homeé”®

å½“å‰æ²¡æœ‰å‘ç°èƒ½åŒå‡» Home é”®çš„æ–¹æ³•, æœ‰çŸ¥é“çš„è€å“¥, è¯·ç•™è¨€å‘Šè¯‰æˆ‘  

```swift
// å•å‡» Home é”®
XCUIDevice.shared.press(.home)
```

## ç³»ç»ŸéŸ³é‡æŒ‰é”®

```swift
// è°ƒèŠ‚éŸ³é‡, +
XCUIDevice.shared.press(.volumeUp)

// è°ƒèŠ‚éŸ³é‡, -
XCUIDevice.shared.press(.volumeDown)
```

## Siri

çªç„¶å”¤é†’ Siri, ä¼šè¯´è¯å¾ˆå¤§å£°, åœ¨å…¬å¸ç©è€çš„è¯, å»ºè®®å…ˆè°ƒå°å£° ğŸ˜

```swift
// å”¤é†’ Siri, å¹¶è¾“å…¥è¯­å¥
XCUIDevice.shared.siriService.activate(voiceRecognitionText: "æˆ‘å¸…ä¹ˆ?");
```


## è®¾å¤‡è½¬æ–¹å‘

æ³¨æ„, æ‰‹æœºè¦å…ˆå…è®¸è½¬å‘æ‰è¡Œ

```swift
// è°ƒèŠ‚æ–¹å‘
XCUIDevice.shared.orientation = .landscapeLeft
```


# é¡¹ç›®åœ°å€

ä¸çŸ¥ä¸è§‰, å†™äº†é‚£ä¹ˆå¤š...æœ‰ç‚¹å•°å—¦äº†ğŸ˜‘  
è¿™é‡Œç»™ä¸Š [é¡¹ç›®](https://github.com/SyKingW/XQUITestDemo) åœ°å€, æƒ³çœ‹ä»£ç çš„, å°±å»ä¸‹è½½å§







